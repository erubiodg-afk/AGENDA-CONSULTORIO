<!doctype html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Cache Control: Force fresh load -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <title>Consultorio - Dra. Claudia Franco</title>

  <!-- Google Identity Services (Necesario para revocaciÃ³n cliente) -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script>
    window.onload = function () {
      if (window.google && window.google.accounts && window.google.accounts.id) {
        // CONFIGURACIÃ“N ANTI-SILENT AUTH (Solicitada)
        try {
          // Si tienes tu Client ID, ponlo aquÃ­. Si no, disableAutoSelect() es la defensa principal.
          google.accounts.id.initialize({
            client_id: "YOUR_GOOGLE_CLIENT_ID_HERE",
            auto_select: false, // <--- CRÃTICO: ESTO ES FALSE
            ux_mode: 'redirect'
          });
          // Prompt explÃ­cito
          // google.accounts.id.prompt(); 
        } catch (e) { console.warn("GSI Init partial:", e); }

        // LLAMADA DIRECTA OBLIGATORIA
        try {
          window.google.accounts.id.disableAutoSelect();
          console.log("Anti-Gravity: GSI AutoSelect DISABLED");
        } catch (e) { console.error(e); }
      }
    }
  </script>

  <!-- CRITICAL: Script de Limpieza Temprana (Bloqueo de SesiÃ³n) -->
  <script>
      (function () {
        // Verificar si estamos en flujo de logout
        const params = new URLSearchParams(window.location.search);
        if (params.get('logout') === 'true') {
          console.warn("ðŸ”’ SECURITY: Forced Logout & Cookie Nuke");

          // 1. Limpieza Local
          try {
            window.localStorage.clear();
            window.sessionStorage.clear();
          } catch (e) { console.error(e); }

          // 2. Limpieza de Cookies EspecÃ­ficas de Google y Generales
          const cookiesToNuke = [
            "G_AUTHUSER_H", // <--- CRÃTICO (Solicitado por usuario)
            "G_ENABLED_IDPS",
            "G_AUTHUSER_H",
            "G_AUTHUSER",
            "sb-access-token",
            "sb-refresh-token"
          ];

          // Borrado dirigido
          cookiesToNuke.forEach(name => {
            document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain=" + window.location.hostname;
            document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/";
          });

          // Borrado escoba (todo lo demÃ¡s)
          var cookies = document.cookie.split(";");
          for (var i = 0; i < cookies.length; i++) {
            var cookie = cookies[i];
            var eqPos = cookie.indexOf("=");
            var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
            document.cookie = name.trim() + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/";
          }

          // 3. Limpiar URL
          const newUrl = window.location.protocol + "//" + window.location.host + window.location.pathname;
          window.history.replaceState({}, document.title, newUrl);
        }
      })();
  </script>
</head>

<body>
  <div id="root"></div>
  <script type="module" src="/src/main.jsx"></script>
</body>

</html>